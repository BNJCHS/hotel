{% extends 'administracion/base_admin.html' %}
{% block title %}Reservas{% endblock %}

{% block content %}
<h2>Listado de reservas</h2>

<table class="table table-striped">
  <thead>
    <tr>
      <th>ID</th>
      <th>Cliente</th>
      <th>Habitación</th>
      <th>Check-in</th>
      <th>Check-out</th>
      <th>Estado</th>
      <th>Acciones</th>
    </tr>
  </thead>
  <tbody>
    {% for reserva in reservas %}
      <tr>
        <td>{{ reserva.id }}</td>
        <td>{{ reserva.usuario.get_full_name|default:reserva.usuario.username }}</td>
        <td>{{ reserva.tipo_habitacion.nombre }} ({{ reserva.cantidad_habitaciones }} hab.)</td>
        <td>{{ reserva.check_in }}</td>
        <td>{{ reserva.check_out }}</td>
        <td>
          {% if reserva.estado == 'activa' %}
            <span class="badge bg-success">Activa</span>
          {% elif reserva.estado == 'confirmada' %}
            <span class="badge bg-info">Confirmada</span>
          {% elif reserva.estado == 'cancelada' %}
            <span class="badge bg-danger">Cancelada</span>
          {% else %}
            <span class="badge bg-warning">Pendiente</span>
          {% endif %}
        </td>
        <td>
          {% if reserva.estado == 'pendiente' %}
            <form method="post" action="{% url 'administracion:confirmar_reserva_admin' reserva.id %}" style="display:inline;">
              {% csrf_token %}
              <button class="btn btn-sm btn-success" type="submit">Confirmar</button>
            </form>

            <form method="post" action="{% url 'administracion:rechazar_reserva_admin' reserva.id %}" style="display:inline; margin-left:5px;">
              {% csrf_token %}
              <button class="btn btn-sm btn-danger" type="submit"
                      onclick="return confirm('¿Seguro que querés rechazar la reserva?')">
                Rechazar
              </button>
            </form>
          {% else %}
            <span class="text-muted">Sin acciones</span>
          {% endif %}
        </td>
      </tr>
    {% empty %}
      <tr>
        <td colspan="7">No hay reservas</td>
      </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
