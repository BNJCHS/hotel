{% extends "administracion/base_admin.html" %}
{% block title %}Planes{% endblock %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-2">
  <h2 class="mb-0">Planes</h2>
  {% if permisos.planes.crear %}
  <a href="{% url 'administracion:planes_create' %}" class="btn btn-success">Nuevo plan</a>
  {% endif %}
</div>

{% include "administracion/_list_toolbar.html" %}

<table class="table table-striped align-middle">
  <thead>
    <tr>
      <th>Nombre</th>
      <th>Precio</th>
      <th>Descripci√≥n</th>
      <th class="text-end">Acciones</th>
    </tr>
  </thead>
  <tbody>
    {% for p in page_obj.object_list %}
    <tr>
      <td>{{ p.nombre }}</td>
      <td>${{ p.precio }}</td>
      <td class="text-truncate" style="max-width: 400px;">{{ p.descripcion }}</td>
      <td class="text-end">
        {% if permisos.planes.editar %}
        <form method="post" action="{% url 'administracion:planes_send_email' p.id %}" style="display:inline-block; margin-right: 6px;">
          {% csrf_token %}
          <button type="submit" class="btn btn-sm btn-primary">Enviar por email</button>
        </form>
        {% endif %}
        {% if permisos.planes.ver %}
        <a href="{% url 'administracion:planes_preview_email' p.id %}" class="btn btn-sm btn-outline-secondary" target="_blank" style="margin-right: 6px;">Previsualizar email</a>
        {% endif %}
        {% if permisos.planes.editar %}
        <a href="{% url 'administracion:planes_edit' p.id %}" class="btn btn-sm btn-warning">Editar</a>
        {% endif %}
        {% if permisos.planes.eliminar %}
        <a href="{% url 'administracion:planes_delete' p.id %}" class="btn btn-sm btn-danger">Eliminar</a>
        {% endif %}
      </td>
    </tr>
    {% empty %}
    <tr><td colspan="4" class="text-center text-muted">Sin planes registrados.</td></tr>
    {% endfor %}
  </tbody>
</table>

{% include "administracion/_pagination.html" %}
{% endblock %}
